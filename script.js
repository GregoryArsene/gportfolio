document.addEventListener("DOMContentLoaded",(()=>{const e=initLenis(),{openMenu:t,closeMenu:n}=initMenu(e);initBarba(e,n),initLinesAnimations(),initLogoReveal()}));const easeInOutCubic=CustomEase.create("custom","M0,0,C0.16,1,0.30,1,1,1"),easeOutExpo=CustomEase.create("custom","M0,0 C0.25,0.1 0.25,1 1,1"),easeInOutExpo=CustomEase.create("custom","M0,0,C0.76,0,0.20,1,1,1");function initLenis(){const e=new Lenis({lerp:.09,orientation:"vertical",wheelMultiplier:1.6});return requestAnimationFrame((function t(n){e.raf(n),requestAnimationFrame(t)})),e}function initMenu(e){const t=document.querySelector(".menu"),n=document.querySelector(".menu-trigger"),o={triggerText:document.querySelectorAll(".menu-trigger-text"),linkTitles:document.querySelectorAll(".menu-link-title"),social:document.querySelectorAll("[menu-social]")};let a=!1,i=null;function r(e){return i&&i.kill(),i=gsap.timeline(),e?i.to(t,{x:"0%",opacity:1,duration:.8,ease:easeInOutCubic}).to(o.triggerText,{y:"-100%",duration:.5,ease:easeOutExpo},0).fromTo([...o.linkTitles,...o.social],{y:"150%"},{y:"0%",duration:.5,stagger:.05,ease:easeOutExpo},.2):i.to(t,{opacity:0,duration:.2,ease:"power2.inOut",onComplete:()=>gsap.set(t,{x:"100%"})}).to(o.triggerText,{y:"0%",duration:.3,ease:"power2.inOut"},0),i}function s(){a||(a=!0,document.body.classList.add("menu-open"),e.stop(),r(!0))}function l(){a&&(a=!1,r(!1).then((()=>{document.body.classList.remove("menu-open"),e.start()})))}return n.addEventListener("click",(e=>{e.stopPropagation(),a?l():s()})),document.addEventListener("click",(e=>{a&&!t.contains(e.target)&&e.target!==n&&l()})),t.addEventListener("click",(e=>e.stopPropagation())),t.querySelectorAll("a").forEach((e=>{e.addEventListener("click",(t=>{const n=e.getAttribute("href");n&&!e.classList.contains("secondary-nav-item")&&(t.preventDefault(),l(),queueMicrotask((()=>barba.go(n))))}))})),{openMenu:s,closeMenu:l}}function initBarba(e,t){barba.hooks.before((t=>{e.stop(),saveScrollPosition(t.current.url.path)})),barba.hooks.after((n=>{t(),e.start(),"back"===n.trigger||"forward"===n.trigger?restoreScrollPosition(n.next.url.path):window.scrollTo(0,0),initMediaControls(),initProjectPageHero()})),barba.init({transitions:[{preventRunning:!0,async leave(){await pageEnterAnimation().catch(console.error)},enter(e){updateCurrentClass();const t=e.next.container;resetWebflow(e),gsap.to(t,{onComplete:()=>{pageExitAnimation(),initLogoReveal(),initLinesAnimations(),initLabGallery()}})}}],prefetch:!0})}function initLinesAnimations(){function e(e,t){document.querySelectorAll(e).forEach((e=>{e._splitType&&SplitType.revert(e);new SplitType(e,{types:"lines"}).lines.forEach(((e,n)=>{const o=document.createElement("div");o.style.overflow="hidden",e.parentNode.insertBefore(o,e),o.appendChild(e),gsap.fromTo(e,{y:t.fromY},{y:"0%",duration:t.duration,ease:easeInOutCubic,delay:t.baseDelay+n*t.staggerDelay,scrollTrigger:t.scrollTrigger})}))}))}e("[line-first]",{fromY:"300%",duration:.8,baseDelay:.4,staggerDelay:.1}),e("[line-second]",{fromY:"300%",duration:.8,baseDelay:.5,staggerDelay:.1})}function initLogoReveal(){gsap.timeline().fromTo([".logo-path-1",".logo-path-2",".logo-path-3"],{y:"120%"},{y:"0%",ease:easeOutExpo,stagger:.1,delay:.2,duration:.8})}function initProjectPageHero(){const e=document.querySelector(".project-hero-img");e&&gsap.timeline().to(e,{duration:1.2,scale:1,delay:.4,ease:easeInOutCubic}).to(e,{y:"-8%",scrollTrigger:{trigger:e,start:"top bottom",end:"bottom top",scrub:.1,ease:"none"}})}function initMediaControls(){const e=document.getElementById("myVideo"),t=document.getElementById("playPauseBtn"),n=document.getElementById("timeRemaining");e&&t&&n&&(gsap.set([t,n],{opacity:0}),e.pause(),t.textContent="Play",e.addEventListener("click",(()=>{e.paused?(e.play(),t.textContent="Pause"):(e.pause(),t.textContent="Play")})),e.addEventListener("timeupdate",(()=>{const t=e.duration-e.currentTime,o=Math.floor(t/60),a=Math.floor(t%60);n.textContent=`${o.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`})),e.addEventListener("mouseenter",(()=>{gsap.to([t,n],{opacity:1,duration:.2})})),e.addEventListener("mouseleave",(()=>{gsap.to([t,n],{opacity:0,duration:.2,delay:.5})})))}function initLabGallery(){const e=document.querySelectorAll(".minimap .img-minimap"),t=gsap.utils.toArray(".gallery .gallery-img-container");gsap.set(t,{display:"none"}),gsap.set(t[0],{display:"block",opacity:1}),loadImage(t[0]),e.forEach(((e,n)=>{e.addEventListener("click",(()=>{gsap.to(t,{duration:.5,ease:"power1.inOut",opacity:e=>e===n?1:0,display:e=>e===n?"block":"none",onStart:()=>{loadImage(t[n])}})}))}))}function loadImage(e){const t=e.querySelector("img");null===t.getAttribute("src")&&t.setAttribute("src",t.getAttribute("data-src"))}function pageEnterAnimation(){return gsap.timeline().set(".page-transition",{display:"block"}).to(".page-transition",{duration:.8,y:"0%",ease:easeInOutExpo}).fromTo(".opacity-transition",{opacity:0,display:"block"},{opacity:.8,duration:1,ease:"linear",display:"none"},"-=1").then((()=>Promise.resolve()))}function pageExitAnimation(){return gsap.timeline().set(".page-transition",{y:"0%"}).to(".page-transition",{duration:.8,y:"-100%",ease:easeInOutExpo}).to(".opacity-transition",{duration:1,opacity:0,ease:"linear"},"-=1").set(".page-transition",{display:"none",y:"100%"}).then((()=>Promise.resolve()))}function updateCurrentClass(){document.querySelectorAll(".w-current").forEach((e=>e.classList.remove("w--current"))),document.querySelectorAll(".nav a").forEach((e=>{e.getAttribute("href")===window.location.pathname&&e.classList.add("w--current")}))}function resetWebflow(e){const t=(new DOMParser).parseFromString(e.next.html,"text/html").querySelector("html").getAttribute("data-wf-page");window.Webflow&&(document.documentElement.setAttribute("data-wf-page",t),window.Webflow.destroy(),window.Webflow.ready(),window.Webflow.require("ix2").init())}barba.hooks.after((e=>{const t=document.getElementById("myVideo");t&&(t.load(),t.play())})),window.addEventListener("popstate",(()=>{const e=performance.getEntriesByType("navigation")[0].type;barba.go(window.location.href,{trigger:e})})),initLabGallery();