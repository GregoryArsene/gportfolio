const customEaseInOut=CustomEase.create("custom","M0,0,C0.16,1,0.30,1,1,1"),menuLinkRevealEase=CustomEase.create("custom","M0,0 C0.25,0.1 0.25,1 1,1"),labLetterEase=CustomEase.create("custom","M0,0 C0.368,0.02 0.011,0.997 1,1");function isWebflowCSSLoaded(){let e=!!document.querySelector(".page-code-preloader");return e}function initPreloader(){document.fonts.ready.then(()=>{if(isWebflowCSSLoaded())document.documentElement.classList.add("is-ready");else{let e=setInterval(()=>{isWebflowCSSLoaded()&&(document.documentElement.classList.add("is-ready"),clearInterval(e))},100)}})}function initLenis(){let e=new Lenis({lerp:.09,orientation:"vertical",wheelMultiplier:1.7,smoothTouch:!0,smoothWheel:!0});function t(n){e.raf(n),requestAnimationFrame(t)}return requestAnimationFrame(t),e}function forceCloseMenu(e,t){let n=document.body.classList.contains("menu-open");n&&(gsap.to(e,{opacity:0,duration:.2,ease:"power2.inOut",onComplete(){gsap.set(e,{x:"100%"}),document.body.classList.remove("menu-open"),e.setAttribute("aria-hidden","true"),t.setAttribute("aria-expanded","false"),t.focus()}}),gsap.to(".menu-trigger_text",{y:"0%",duration:.3,ease:"power2.inOut"}))}function initMenu(e){let t=document.querySelector(".menu"),n=document.querySelector(".menu-trigger"),r={triggerText:document.querySelectorAll(".menu-trigger_text"),linkTitles:document.querySelectorAll(".primary-nav_title"),social:document.querySelectorAll(".secondary-nav_title")},i=!1,o=null;function a(e){return o&&o.kill(),o=gsap.timeline({onComplete(){o=null}}),e?o.to(t,{x:"0%",opacity:1,duration:.8,ease:customEaseInOut}).to(r.triggerText,{y:"-100%",duration:.5,ease:menuLinkRevealEase},0).fromTo([...r.linkTitles,...r.social],{y:"150%"},{y:"0%",duration:.5,stagger:.05,ease:menuLinkRevealEase},.2):o.to(t,{opacity:0,duration:.2,ease:"power2.inOut",onComplete:()=>gsap.set(t,{x:"100%"})}).to(r.triggerText,{y:"0%",duration:.3,ease:"power2.inOut"},0),o}function s(){i||(i=!0,document.body.classList.add("menu-open"),a(!0),t.setAttribute("aria-hidden","false"),n.setAttribute("aria-expanded","true"),t.focus())}function l(){return i?(i=!1,a(!1).then(()=>{document.body.classList.remove("menu-open"),t.setAttribute("aria-hidden","true"),n.setAttribute("aria-expanded","false"),n.focus()})):Promise.resolve()}t.setAttribute("tabindex","-1"),window.addEventListener("resize",function e(){window.innerWidth>568&&i&&forceCloseMenu(t,n)});let c=e=>{if(n.contains(e.target)){e.stopPropagation(),i?l():s();return}if(i&&!t.contains(e.target)){l();return}if("A"===e.target.tagName&&t.contains(e.target)){let r=e.target,o=r.getAttribute("href");o&&!r.classList.contains("secondary-nav_link")&&(e.preventDefault(),l(),setTimeout(()=>{barba.go(o)},300))}};return document.addEventListener("click",c),{openMenu:s,closeMenu:l,forceCloseMenu}}function initBarba(e,t){barba.hooks.before(t=>{e.stop(),saveScrollPosition(t.current.url.path)}),barba.hooks.after(t=>{document.documentElement.style.height="auto",document.body.style.height="auto",e.start();let n=document.querySelector(".menu"),r=document.querySelector(".menu-trigger");forceCloseMenu(n,r),"back"===t.trigger||"forward"===t.trigger?restoreScrollPosition(t.next.url.path):window.scrollTo(0,0),requestAnimationFrame(()=>{let e=[initProjectPageHero,initProjectDisplay,initDisplayHover,initLinesAnimations,initVideoPlayer];e.forEach(e=>{try{e()}catch(t){console.error(`Error in page initialization: ${e.name}`,t)}})})}),barba.init({prefetchIgnore:!0,transitions:[{preventRunning:!0,async leave(e){await pageEnterAnimation().catch(console.error)},enter(e){updateCurrentClass();let t=e.next.container;resetWebflow(e),gsap.to(t,{onComplete(){if(pageExitAnimation(),initLinesAnimations(),initProjectDisplay(),projectIndex(),initLabLetter(),initVideoPlayer(),window.innerWidth>568){let e=document.querySelector(".menu"),t=document.querySelector(".menu-trigger");forceCloseMenu(e,t)}}})}},],prefetch:!0,debug:!1})}function saveScrollPosition(e){sessionStorage.setItem("scrollPosition_"+e,window.pageYOffset)}function restoreScrollPosition(e){let t=sessionStorage.getItem("scrollPosition_"+e);null!==t?window.scrollTo(0,parseInt(t)):window.scrollTo(0,0)}function initLinesAnimations(){function e(e,t){document.querySelectorAll(e).forEach(e=>{e._splitType&&SplitType.revert(e);let n=new SplitType(e,{types:"lines"});n.lines.forEach((e,n)=>{let r=document.createElement("div");r.style.overflow="hidden",e.parentNode.insertBefore(r,e),r.appendChild(e),gsap.fromTo(e,{y:t.fromY},{y:"0%",duration:t.duration,ease:customEaseInOut,delay:t.baseDelay+n*t.staggerDelay,scrollTrigger:t.scrollTrigger})})})}e("[line-text]",{fromY:"300%",duration:.8,baseDelay:.4,staggerDelay:.1}),e("[line-text-2]",{fromY:"300%",duration:.8,baseDelay:.5,staggerDelay:.1})}function initProjectDisplay(){let e=document.querySelector(".projects-display_btn.is--index"),t=document.querySelector(".projects-display_btn.is--grid"),n=document.querySelector(".index"),r=document.querySelector(".projects");if(!e||!t||!n||!r){console.warn("Les \xe9l\xe9ments n\xe9cessaires pour initProjectDisplay sont absents de cette page.");return}function i(e,t){e.classList.add("btn_selected"),e.classList.remove("btn_not-selected"),t.classList.add("btn_not-selected"),t.classList.remove("btn_selected")}t.classList.add("btn_selected"),t.classList.remove("btn_not-selected"),e.classList.add("btn_not-selected"),e.classList.remove("btn_selected"),e.addEventListener("click",()=>{n.style.display="block",r.classList.add("inactive"),requestAnimationFrame(()=>{n.classList.add("active"),n.classList.remove("inactive")}),setTimeout(()=>{r.style.display="none"},250),i(e,t)}),t.addEventListener("click",()=>{r.style.display="block",n.classList.add("inactive"),requestAnimationFrame(()=>{r.classList.add("active"),r.classList.remove("inactive")}),setTimeout(()=>{n.style.display="none"},250),i(t,e)})}function projectIndex(){let e=document.querySelectorAll(".projects-index_item");e.forEach((e,t)=>{e.addEventListener("mouseenter",()=>{document.querySelector(`#index-img-${t+1}`).style.opacity="1"}),e.addEventListener("mouseleave",()=>{document.querySelector(`#index-img-${t+1}`).style.opacity="0"})})}function initProjectPageHero(){let e=document.querySelector(".hero-project_img");e&&gsap.timeline().to(e,{duration:1.2,scale:1,delay:.9,ease:customEaseInOut}).to(e,{y:"-8%",scrollTrigger:{trigger:e,start:"top bottom",end:"bottom top",scrub:.1,ease:"none"}})}function initVideoPlayer(){document.querySelectorAll(".video-player").forEach(e=>{let t=e.querySelector("video"),n=e.querySelector(".video-controls"),r=e.querySelector(".video-time"),i;if(!t||!n||!r){console.warn("\xc9l\xe9ments vid\xe9o manquants dans un conteneur .video-player");return}gsap.set([n,r],{opacity:0}),t.pause(),n.textContent="Play",e.addEventListener("click",()=>{t.paused?(t.play(),n.textContent="Pause"):(t.pause(),n.textContent="Play")}),t.addEventListener("timeupdate",()=>{let e=t.duration-t.currentTime;r.textContent=`${Math.floor(e/60).toString().padStart(2,"0")}:${Math.floor(e%60).toString().padStart(2,"0")}`}),e.addEventListener("mouseenter",()=>{gsap.to([n,r],{opacity:1,duration:.5}),clearTimeout(i)}),e.addEventListener("mouseleave",()=>{i=setTimeout(()=>{gsap.to([n,r],{opacity:0,duration:1})},3e3)})})}function initLabLetter(){gsap.fromTo("#lab-letter-left",{x:"15vw"},{x:0,duration:2,ease:labLetterEase,scrollTrigger:{trigger:".home-lab_btm",start:"top 80%",toggleActions:"play none none none"}}),gsap.fromTo("#lab-letter-right",{x:"-15vw"},{x:0,duration:2,ease:labLetterEase,scrollTrigger:{trigger:".home-lab_btm",start:"top 80%",toggleActions:"play none none none"}})}async function pageEnterAnimation(){return gsap.timeline().set(".page-transition",{display:"block"}).to(".page-transition",{duration:.8,y:"0%",ease:CustomEase.create("custom","M0,0,C0.76,0,0.20,1,1,1")}).fromTo(".page-content",{y:"0vh"},{duration:.8,y:"-100vh",ease:CustomEase.create("custom","M0,0,C0.76,0,0.20,1,1,1")},"-=0.8").fromTo(".opacity-transition",{opacity:0,display:"block"},{opacity:.8,duration:1,ease:"linear",display:"none"},"-=1")}async function pageExitAnimation(){return gsap.timeline().set(".page-transition",{y:"0%"}).to(".page-transition",{duration:.8,y:"-100%",ease:CustomEase.create("custom","M0,0,C0.76,0,0.20,1,1,1")}).fromTo(".page-content",{y:"50vh"},{duration:.8,y:"0vh",ease:CustomEase.create("custom","M0,0,C0.76,0,0.20,1,1,1")},"-=0.8").to(".opacity-transition",{duration:1,opacity:0,ease:"linear"},"-=1").set(".page-transition",{display:"none",y:"100%"})}function updateCurrentClass(){document.querySelectorAll(".w-current").forEach(e=>e.classList.remove("w--current")),document.querySelectorAll(".nav a").forEach(e=>{e.getAttribute("href")===window.location.pathname&&e.classList.add("w--current")})}function resetWebflow(e){try{let t=new DOMParser,n=t.parseFromString(e.next.html,"text/html"),r=n.querySelector("html")?.getAttribute("data-wf-page");r&&document.documentElement.setAttribute("data-wf-page",r),window.Webflow&&(window.Webflow.destroy(),window.Webflow.ready(),window.Webflow.require("ix2")?.init())}catch(i){console.error("Webflow reset error:",i)}}window.addEventListener("popstate",()=>{let e=performance.getEntriesByType("navigation")[0].type;barba.go(window.location.href,{trigger:e}),initLinesAnimations()}),window.addEventListener("error",e=>{console.error("Uncaught error:",e.error)}),document.addEventListener("DOMContentLoaded",()=>{initPreloader();let e=initLenis(),{openMenu:t,closeMenu:n}=initMenu(e);requestAnimationFrame(()=>{initBarba(e,n),initLinesAnimations(),initProjectPageHero(),initLabLetter(),initVideoPlayer(),document.querySelector(".projects-display_btn.is--index")&&initProjectDisplay(),document.querySelector(".projects-display_btn.is--grid")&&initDisplayHover(),projectIndex()})});