const customEaseInOut=CustomEase.create("custom","M0,0,C0.16,1,0.30,1,1,1"),menuLinkRevealEase=CustomEase.create("custom","M0,0 C0.25,0.1 0.25,1 1,1");function initLenis(){const e=new Lenis({lerp:.09,orientation:"vertical",wheelMultiplier:1.7});return requestAnimationFrame((function t(n){e.raf(n),requestAnimationFrame(t)})),e}function initMenu(e){const t=document.querySelector(".menu"),n=document.querySelector(".menu-trigger"),o={triggerText:document.querySelectorAll(".menu-trigger-text"),linkTitles:document.querySelectorAll(".menu-link-title"),social:document.querySelectorAll("[menu-social]")};let i=!1;function a(e){let n=gsap.timeline();return e?n.to(t,{x:"0%",opacity:1,duration:.8,ease:customEaseInOut}).to(o.triggerText,{y:"-100%",duration:.5,ease:menuLinkRevealEase},0).fromTo([...o.linkTitles,...o.social],{y:"150%"},{y:"0%",duration:.5,stagger:.05,ease:menuLinkRevealEase},.2):n.to(t,{opacity:0,duration:.2,ease:"power2.inOut",onComplete:()=>gsap.set(t,{x:"100%"})}).to(o.triggerText,{y:"0%",duration:.3,ease:"power2.inOut"},0),n}function r(){i||(i=!0,document.body.classList.add("menu-open"),e.stop(),a(!0))}function s(){return i?(i=!1,a(!1).then((()=>{document.body.classList.remove("menu-open"),e.start()}))):Promise.resolve()}return n.addEventListener("click",(e=>{e.stopPropagation(),i?s():r()})),document.addEventListener("click",(e=>{i&&!t.contains(e.target)&&e.target!==n&&s()})),t.addEventListener("click",(e=>{if("A"===e.target.tagName){const t=e.target,n=t.getAttribute("href");if(n){if(t.classList.contains("secondary-nav-item"))return void e.stopPropagation();e.preventDefault(),s(),setTimeout((()=>{barba.go(n)}),300)}}})),{openMenu:r,closeMenu:s}}function initBarba(e,t){barba.hooks.before((t=>{e.stop(),saveScrollPosition(t.current.url.path)})),barba.hooks.after((n=>{t(),e.start(),"back"===n.trigger||"forward"===n.trigger?restoreScrollPosition(n.next.url.path):window.scrollTo(0,0),initMediaControls(),initProjectPageHero()})),barba.init({transitions:[{preventRunning:!0,async leave(){await pageEnterAnimation().catch(console.error)},enter(e){updateCurrentClass();const t=e.next.container;resetWebflow(e),gsap.to(t,{onComplete:()=>{pageExitAnimation(),initLogoReveal(),initLinesAnimations()}})}}],prefetch:!0})}function saveScrollPosition(e){sessionStorage.setItem("scrollPosition_"+e,window.pageYOffset)}function restoreScrollPosition(e){const t=sessionStorage.getItem("scrollPosition_"+e);null!==t?window.scrollTo(0,parseInt(t)):window.scrollTo(0,0)}function initLinesAnimations(){var e,t;e="[line-text]",t={fromY:"300%",duration:.8,baseDelay:.4,staggerDelay:.1},document.querySelectorAll(e).forEach((e=>{e._splitType&&SplitType.revert(e),new SplitType(e,{types:"lines"}).lines.forEach(((e,n)=>{const o=document.createElement("div");o.style.overflow="hidden",e.parentNode.insertBefore(o,e),o.appendChild(e),gsap.fromTo(e,{y:t.fromY},{y:"0%",duration:t.duration,ease:customEaseInOut,delay:t.baseDelay+n*t.staggerDelay,scrollTrigger:t.scrollTrigger})}))}))}function initLogoReveal(){gsap.timeline().fromTo([".logo-path-1",".logo-path-2",".logo-path-3"],{y:"120%"},{y:"0%",ease:menuLinkRevealEase,stagger:.1,delay:.2,duration:.8})}function initProjectPageHero(){const e=document.querySelector(".project-hero-img");e&&gsap.timeline().to(e,{duration:1.2,scale:1,delay:.9,ease:customEaseInOut}).to(e,{y:"-8%",scrollTrigger:{trigger:e,start:"top bottom",end:"bottom top",scrub:.1,ease:"none"}})}function initMediaControls(){const e=document.getElementById("myVideo"),t=document.getElementById("playPauseBtn"),n=document.getElementById("timeRemaining");e&&t&&n&&(gsap.set([t,n],{opacity:0}),e.pause(),t.textContent="Play",e.addEventListener("click",(()=>{e.paused?(e.play(),t.textContent="Pause"):(e.pause(),t.textContent="Play")})),e.addEventListener("timeupdate",(()=>{const t=e.duration-e.currentTime,o=Math.floor(t/60),i=Math.floor(t%60);n.textContent=`${o.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`})),e.addEventListener("mouseenter",(()=>{gsap.to([t,n],{opacity:1,duration:.2})})),e.addEventListener("mouseleave",(()=>{gsap.to([t,n],{opacity:0,duration:.2,delay:.5})})))}async function pageEnterAnimation(){return gsap.timeline().set(".page-transition",{display:"block"}).to(".page-transition",{duration:.8,y:"0%",ease:CustomEase.create("custom","M0,0,C0.76,0,0.20,1,1,1")}).fromTo(".page-content",{y:"0vh"},{duration:.8,y:"-100vh",ease:CustomEase.create("custom","M0,0,C0.76,0,0.20,1,1,1")},"-=0.8").fromTo(".opacity-transition",{opacity:0,display:"block"},{opacity:.8,duration:1,ease:"linear",display:"none"},"-=1")}async function pageExitAnimation(){return gsap.timeline().set(".page-transition",{y:"0%"}).to(".page-transition",{duration:.8,y:"-100%",ease:CustomEase.create("custom","M0,0,C0.76,0,0.20,1,1,1")}).fromTo(".page-content",{y:"50vh"},{duration:.8,y:"0vh",ease:CustomEase.create("custom","M0,0,C0.76,0,0.20,1,1,1")},"-=0.8").to(".opacity-transition",{duration:1,opacity:0,ease:"linear"},"-=1").set(".page-transition",{display:"none",y:"100%"})}function updateCurrentClass(){document.querySelectorAll(".w-current").forEach((e=>e.classList.remove("w--current"))),document.querySelectorAll(".nav a").forEach((e=>{e.getAttribute("href")===window.location.pathname&&e.classList.add("w--current")}))}function resetWebflow(e){const t=(new DOMParser).parseFromString(e.next.html,"text/html").querySelector("html").getAttribute("data-wf-page");window.Webflow&&(document.documentElement.setAttribute("data-wf-page",t),window.Webflow.destroy(),window.Webflow.ready(),window.Webflow.require("ix2").init())}barba.hooks.after((e=>{const t=document.getElementById("myVideo");t&&(t.load(),t.play())})),window.addEventListener("popstate",(()=>{const e=performance.getEntriesByType("navigation")[0].type;barba.go(window.location.href,{trigger:e}),initLinesAnimations(),initLogoReveal()})),document.addEventListener("DOMContentLoaded",(()=>{const e=initLenis(),{openMenu:t,closeMenu:n}=initMenu(e);initBarba(e,n),initLinesAnimations(),initLogoReveal(),initMediaControls(),initProjectPageHero()}));